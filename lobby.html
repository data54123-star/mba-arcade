<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arcade Lobby</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#000000">
    <style>
        body { 
            background-color: #111; 
            color: #fff; 
            font-family: 'Courier New', monospace; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
            padding: 20px;
            box-sizing: border-box; /* Wichtig f√ºr Grid */
        }

        h1 { color: #00ff00; text-shadow: 0 0 10px rgba(0,255,0,0.5); margin-bottom: 10px; text-align: center; }
        
        /* --- AVATAR VORSCHAU --- */
        #current-user-avatar {
            width: 80px; height: 80px;
            border-radius: 50%;
            border: 2px solid #00ff00;
            margin-bottom: 10px;
            object-fit: cover;
            box-shadow: 0 0 15px rgba(0,255,0,0.3);
        }

        /* --- CONTAINER STEUERUNG --- */
        .view-section { display: none; width: 100%; max-width: 1000px; flex-direction: column; align-items: center; }
        .active { display: flex; }

        /* --- DAS NEUE 12-COLUMN GRID SYSTEM --- */
        .game-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr); /* 12 Spalten */
            gap: 20px; /* Abstand zwischen den Karten */
            width: 100%;
            margin-top: 20px;
        }

        /* --- KARTEN DESIGN --- */
        .game-card {
            /* STANDARD (Mobile): Nimmt volle 12 Spalten */
            grid-column: span 12; 
            
            background: #222; 
            border: 1px solid #444; 
            border-radius: 10px;
            padding: 30px 20px; 
            text-align: center;
            cursor: pointer; 
            transition: transform 0.2s, border-color 0.2s, box-shadow 0.2s;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 150px; /* Einheitliche H√∂he */
        }
        
        .game-card:hover { 
            transform: translateY(-5px); 
            border-color: #00ff00; 
            box-shadow: 0 5px 15px rgba(0,255,0,0.1);
        }

        .game-title { font-size: 1.5rem; color: #fff; font-weight: bold; display: block; margin-bottom: 10px; }
        .game-desc { color: #aaa; font-size: 0.9rem; }

        /* --- MEDIA QUERY F√úR TABLET & PC (ab 768px) --- */
        @media (min-width: 768px) {
            .game-card {
                grid-column: span 6; /* Nimmt 6 von 12 Spalten (also 50%) */
            }
        }

        /* --- BUTTONS --- */
        .btn-container {
            /* Container f√ºr Buttons, der auch im Grid liegen kann oder darunter */
            grid-column: span 12;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
            width: 100%;
        }

        .btn-action {
            margin-top: 15px; width: 100%; max-width: 300px; padding: 12px;
            background: #333; color: white; border: 1px solid #888;
            cursor: pointer; font-family: inherit; font-weight: bold;
            transition: all 0.2s;
        }
        .btn-action:hover { background: #444; border-color: #fff; }

        .btn-logout {
            margin-top: 30px; background: transparent; border: 1px solid #ff4444; color: #ff4444;
            padding: 10px 20px; cursor: pointer; font-family: inherit; border-radius: 5px;
        }
        .btn-logout:hover { background: rgba(255, 68, 68, 0.1); }

        /* --- PROFIL EDIT STYLE (Bleibt zentriert und schmal) --- */
        .profile-container { width: 100%; max-width: 400px; display: flex; flex-direction: column; align-items: center; }
        .avatar-grid { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; margin: 20px 0; }
        .avatar-option {
            width: 60px; height: 60px; border: 2px solid #333; cursor: pointer;
            opacity: 0.6; transition: all 0.2s; object-fit: cover;
        }
        .avatar-option:hover { transform: scale(1.1); opacity: 1; }
        .avatar-option.selected { border-color: #00ff00; opacity: 1; transform: scale(1.1); box-shadow: 0 0 10px #00ff00; }
        input { padding: 10px; width: 100%; background: #222; border: 1px solid #555; color: white; margin-bottom: 10px; box-sizing: border-box;}

    </style>
</head>
<body>

    <h1>MBA ARCADE</h1>
    <img id="current-user-avatar" src="100.jpg" alt="Avatar">
    <p id="user-greeting">Lade...</p>

    <div id="view-dashboard" class="view-section active">
        
        <div class="game-grid">
            
            <div class="game-card" onclick="window.location.href='snake.html'">
                <span class="game-title">üêç MBA SNAKE</span>
                <span class="game-desc">Global Edition</span>
            </div>

            <div class="game-card" style="opacity: 0.5; cursor: not-allowed;">
                <span class="game-title">üöß COMING SOON</span>
                <span class="game-desc">Neues Spiel...</span>
            </div>

            <div class="btn-container">
                <button class="btn-action" onclick="switchView('profile')">‚öôÔ∏è PROFIL BEARBEITEN</button>
                <button class="btn-logout" onclick="logout()">Abmelden</button>
            </div>

        </div>
    </div>

    <div id="view-profile" class="view-section">
        <div class="profile-container">
            <h2 style="color: #00ff00; border-bottom: 1px solid #333; width: 100%; text-align: center;">AVATAR W√ÑHLEN</h2>
            
            <div class="avatar-grid" id="avatar-container">
                </div>

            <h2 style="color: #00ff00; border-bottom: 1px solid #333; width: 100%; text-align: center; margin-top: 20px;">PASSWORT √ÑNDERN</h2>
            <input type="password" id="new-password" placeholder="Neues Passwort eingeben">
            <button class="btn-action" onclick="changeUserPassword()">PASSWORT SPEICHERN</button>

            <hr style="border: 0; border-top: 1px solid #333; width: 100%; margin: 20px 0;">
            
            <button class="btn-action" onclick="switchView('dashboard')">‚óÄ ZUR√úCK ZUR LOBBY</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged, updatePassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // --- DEINE FIREBASE CONFIG EINF√úGEN ---
        const firebaseConfig = {
            apiKey: "AIzaSyASbziojAan2xJ3EoJ0RDPa9jh1Z-5UGX0",
            authDomain: "mba-arcade.firebaseapp.com",
            projectId: "mba-arcade",
            storageBucket: "mba-arcade.firebasestorage.app",
            messagingSenderId: "497628563783",
            appId: "1:497628563783:web:a6a0a272fb97b60bbf6462"
            // ... dein Code ...
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // --- AVATAR LOGIK ---
        const myAvatars = ["100.jpg", "102.jpg", "200.jpg", "205.jpg", "400.jpg"];
        
        function initProfile() {
            const container = document.getElementById('avatar-container');
            const currentImg = document.getElementById('current-user-avatar');
            const savedAvatar = localStorage.getItem('mba_avatar') || myAvatars[0];
            currentImg.src = savedAvatar; 

            container.innerHTML = "";
            myAvatars.forEach(filename => {
                const img = document.createElement('img');
                img.src = filename;
                img.className = 'avatar-option';
                if(filename === savedAvatar) img.classList.add('selected');

                img.onclick = function() {
                    document.querySelectorAll('.avatar-option').forEach(el => el.classList.remove('selected'));
                    img.classList.add('selected');
                    localStorage.setItem('mba_avatar', filename);
                    document.getElementById('current-user-avatar').src = filename;
                };
                container.appendChild(img);
            });
        }

        // --- PASSWORT √ÑNDERN ---
        window.changeUserPassword = function() {
            const newPw = document.getElementById('new-password').value;
            const user = auth.currentUser;
            if (newPw.length < 6) { alert("Passwort muss mindestens 6 Zeichen haben!"); return; }
            if (user) {
                updatePassword(user, newPw).then(() => {
                    alert("Passwort erfolgreich ge√§ndert!");
                    document.getElementById('new-password').value = "";
                }).catch((error) => {
                    if (error.code === 'auth/requires-recent-login') {
                        alert("Bitte logge dich neu ein, um das Passwort zu √§ndern.");
                        logout();
                    } else {
                        alert("Fehler: " + error.message);
                    }
                });
            }
        }

        // --- NAVIGATION ---
        window.switchView = function(viewName) {
            document.getElementById('view-dashboard').classList.remove('active');
            document.getElementById('view-profile').classList.remove('active');
            if(viewName === 'dashboard') document.getElementById('view-dashboard').classList.add('active');
            if(viewName === 'profile') document.getElementById('view-profile').classList.add('active');
        }

        // --- AUTH ---
        onAuthStateChanged(auth, (user) => {
            if (user) {
                const name = user.email.replace("@mba-arcade.com", "");
                document.getElementById("user-greeting").innerText = "Hallo " + name + "!";
                initProfile();
            } else {
                window.location.href = "index.html";
            }
        });

        window.logout = function() {
            signOut(auth).then(() => window.location.href = "index.html");
        }
    </script>
</body>
</html>